@startuml

node "LLM/Agent" as LLM
node "MCP Server" as Server
node "Analysis Service" as AS
node "Swift Parser" as SP
node "SourceKitten" as SK
node "File System" as FS
node "In-memory Cache" as Cache

LLM --> Server : Tool Calls (JSON)
Server --> AS : Tool Inputs (JSON)

AS --> FS : Project Path
FS --> AS : Swift Files

AS --> SP : File Path
SP --> SK : File Path
SK --> SP : SourceKitten Output (JSON)
SP --> AS : CodeChunk[]

AS --> Cache : CodeChunk[]
AS --> FS : CodeChunk (JSON File)

FS --> AS : CodeChunk (JSON File)
Cache --> AS : CodeChunk

AS --> Server : Tool Results (JSON)
Server --> LLM : Tool Results (JSON)

@enduml
